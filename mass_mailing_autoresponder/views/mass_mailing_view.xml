<odoo>
    <data>

        <!-- Mass mailing action under auto responder -->
        <record model="ir.actions.act_window" id="action_autorespond_mailing">
            <field name="name">Mailing</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mail.mass_mailing</field>
            <field name="view_type">form</field>
            <field name="domain">[('auto_responder','=',True)]</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Mass Mailing background data will be generated based on schedule line content to manage
                    statistics.
                </p>
            </field>
        </record>

        <!-- Mass mailing menu under auto responder -->
        <menuitem id="mass_mailing_autoresponder" name="Mailing" action="action_autorespond_mailing" sequence="2"
                  parent="mass_mailing_autoresponder.customer_dialogue_menu_id"/>

        <!-- Override base action to hide backend campgain created from auto responder -->

        <record id="mass_mailing.action_view_mass_mailings" model="ir.actions.act_window">
            <field name="name">Mailings</field>
            <field name="res_model">mail.mass_mailing</field>
            <field name="view_type">form</field>
            <field name="view_mode">kanban,tree,form,graph</field>
            <field name="domain">[('auto_responder','=',False)]</field>
            <field name="context">{
                    'search_default_assigned_to_me': 1,
                    'default_user_id': uid,
            }</field>
            <field name="help" type="html">
              <p class="o_view_nocontent_smiling_face">
                Create a new mailing
              </p><p>
                No need of importing your mailing lists, you can easily
                send emails to any contact saved in other Odoo apps.
              </p>
            </field>
        </record>

        <record id="mass_mailing.action_view_mass_mailings_from_campaign" model="ir.actions.act_window">
            <field name="name">Mailings</field>
            <field name="res_model">mail.mass_mailing</field>
            <field name="view_type">form</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="domain">[('auto_responder','=',False)]</field>
            <field name="context">{
                'search_default_assigned_to_me': 1,
                'search_default_mass_mailing_campaign_id': [active_id],
                'default_mass_mailing_campaign_id': active_id,
                'default_user_id': uid,
            }
            </field>
            <field name="help" type="html">
              <p class="o_view_nocontent_smiling_face">
                Create a new mailing
              </p><p>
                No need of importing your mailing lists, you can easily
                send emails to any contact saved in other Odoo apps.
              </p>
            </field>
        </record>

        <record model="ir.ui.view" id="view_mail_mass_mailing_af_form">
            <field name="name">mail.mass_mailing.af.form</field>
            <field name="model">mail.mass_mailing</field>
            <field name="inherit_id" ref="mass_mailing.view_mail_mass_mailing_form"/>
            <field name="arch" type="xml">
                <button name="put_in_queue" position="replace">
                    <button name="put_in_queue" type="object" attrs="{'invisible': [('state', 'in', ('in_queue', 'done'))]}"
                            class="oe_highlight" string="Send Now"
                            confirm="This will send the email to all recipients. Do you still want to proceed ?"
                            groups="af_security.af_newsletter_manual"/>
                </button>
                <button name="action_schedule_date" position="replace">
                    <button name="action_schedule_date" type="object" attrs="{'invisible': [('state', 'in', ('in_queue', 'done'))]}"
                            class="btn-secondary" string="Schedule"
                            groups="af_security.af_newsletter_manual"/>
                </button>
                <button name="action_test_mailing" position="replace">
                    <button name="action_test_mailing" type="object" class="btn-secondary" string="Test"
                            groups="af_security.af_newsletter_manual"/>
                </button>
                <button name="cancel_mass_mailing" position="replace">
                    <button name="cancel_mass_mailing" type="object" attrs="{'invisible': [('state', '!=', 'in_queue')]}"
                            class="btn-secondary" string="Cancel"
                            groups="af_security.af_newsletter_manual"/>
                </button>
                <button name="retry_failed_mail" position="replace">
                    <button name="retry_failed_mail" type="object"
                            attrs="{'invisible': ['|', ('state', '!=', 'done'), ('failed', '=', 0)]}"
                            class="oe_highlight" string="Retry"
                            groups="af_security.af_newsletter_manual"/>
                </button>
                        <field name="state" readonly="1" widget="statusbar"/>
            </field>
        </record>


    </data>
</odoo>
