<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <template inherit_id="mass_mailing.unsubscribed" id="af_nyhetsbrev_unsubscribed">
        <xpath expr="//div[@id='subscription_info']" position="replace">
            <div id="subscription_info" class="text-center" role="status">
                <p>You have been successfully <strong>unsubscribed</strong>!
                </p>
            </div>
        </xpath>
    </template>

    <template inherit_id="mass_mailing.unsubscribe" id="af_nyhetsbrev_unsubscribe">
        <xpath expr="//h1" position="replace">
            <br/>
            <h1 class="o_page_header" style="color:#00005a;">Mailing Subscriptions</h1>
        </xpath>
        <xpath expr="//form/div/t/p" position="replace">
            <p style="color:#00005a;">Choose your mailing subscriptions</p>
        </xpath>
        <xpath expr="//div[@id='div_opt_out']/div" position="replace">
            <div class="mb64 pt-3">
                <div t-if="show_blacklist_button">
                    <div class="btn pull-right" id="button_add_blacklist"
                         style="display:none;border-color:#00005a;color:#00005a;font-size:17px;border-radius:6px;background-color:#ffffff;">
                        Blacklist Me
                    </div>
                </div>
                <div class="btn pull-right" id="button_remove_blacklist"
                     style="display:none;border-color:#00005a;color:#00005a;font-size:17px;border-radius:6px;background-color:#ffffff;">
                    Come Back
                </div>
                <button type="submit" id="send_form" class="btn"
                        style="border-color:#00005a;color:#00005a;font-size:17px;border-radius:6px;background-color:#ffffff;">
                    Update my subscriptions
                </button>
            </div>
        </xpath>
        <xpath expr="//ul[@class='list-group']/t/t/li/t" position="replace">
            <t style="color:#00005a" t-esc="list_id.name"/>
        </xpath>
        <xpath expr="//div[@id='info_state']" position="attributes">
            <attribute name="class">text-center</attribute>
            <attribute name="style">color:#00005a;font-size:17px;</attribute>
        </xpath>
    </template>

    <template inherit_id="mass_mailing_custom_unsubscribe.reason" id="af_nyhetsbrev_unsubscribe_reason">
        <xpath expr="//div[@id='custom_div_feedback']" position="replace"/>
    </template>

    <template inherit_id="mass_mailing_custom_unsubscribe.reason_form" id="af_nyhetsbrev_unsubscribe_reason_form">
        <xpath expr="//form" position="attributes">
            <attribute name="role">form</attribute>
            <attribute name="aria-labelledby">legend</attribute>
        </xpath>
        <xpath expr="//form" position="inside">
            <fieldset style="margin-top:18px;">
                <legend id="legend" style="color:#00005a; font-size: 14px; margin-bottom: 12px;">
                    Vi skulle uppskatta om du kunde lämna feedback till varför du vill avregistrera dig.
                </legend>
                <div class="col-md-12 mb16">
                    <t t-foreach="reasons" t-as="reason">
                        <div class="radio" style="color:#00005a">
                            <label>
                                <input type="radio" name="reason_id" class="opt" t-att-data-details-required="reason.details_required"
                                       t-att-value="reason.id" required="required"/>
                                <t t-esc="reason.display_name"/>
                            </label>
                        </div>
                    </t>
                </div>
                <div id="other_reason">
                    <label style="color:#00005a;" for="other_reason_textfield">Om du har valt annan orsak, beskriv orsaken här: </label>
                    <textarea id="other_reason_textfield" class="form-control" name="details" cols="60" rows="3"></textarea>
                </div>
                <div class="form-group mb16 mt16">
                    <button onclick="return confirm('Är du säker på att du vill avsluta prenumerationen?')" type="submit" class="button"
                            style="float:right;border-color:#00005a;color:#00005a;font-size:17px;border-radius:6px">
                        <b>Unsubscribe now</b>
                    </button>
                </div>
            </fieldset>
        </xpath>
        <xpath expr="//form/div" position="replace"/>
    </template>


    <template id="web_layout_title_custom" name="change title" inherit_id="web.layout">
        <xpath expr="//title" position="replace">
            <title>Arbetsförmedlingen - Avanmälan</title>
        </xpath>
    </template>

    <template inherit_id="mass_mailing_custom_unsubscribe.reason_form" id="af_nyhetsbrev_unsubscribe_reason_form">
        <xpath expr="//form/div" position="replace">
            <div class="form-group mb16 mt16">
                <button id ="unsubscribe" type="submit" class="button" onclick="return openDialog(event)">
                    <b>Unsubscribe now</b>
                </button>
            </div>
        </xpath>
    </template>

    <template id="mass_mailing.layout" name="Mass Mailing Layout">
        <t t-call="web.layout">
            <t t-set="head">
                <t t-call-assets="web.assets_common"/>
                <t t-call-assets="mass_mailing.assets_backend"/>
            </t>
            <body class="o_white_body">
                <header role="banner">
                    <div class="text-center">
                        <br/>
                        <br/>
                        <img src="/mass_mailing_unsubscribe_af/static/img/login_logo.jpg"
                             alt="Arbetsförmedlingen logotyp"/>
                    </div>
                </header>
                <main role="main">
                    <t t-raw="0"/>
                </main>
                <div id="dialog" aria-labelledby="dialogName" role="dialog" tabindex="-1" hidden="">
                    <div role="document" id="container">
                        <h1 id="dialogName" tabindex="-1">Bekräfta avanmälan</h1>
                        <div id="elementDetail" tabindex="0" role="region" aria-labelledby="dialogName">
                            <p>
                                Är du säker på att du vill avsluta prenumerationen?
                            </p>
                            <div id="button_container">
                                <button type="button" id="dialogSubmit">Avsluta prenumeration</button>
                                <button type="button" id="dialogClose">Avbryt</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="overlay"></div>
            </body>
        </t>
    </template>

    <template id="web_layout_custom" inherit_id="web.layout">
        <xpath expr="//meta[@http-equiv='X-UA-Compatible']" position="attributes">
            <attribute name="content">IE=edge</attribute>
        </xpath>
        <xpath expr="//html" position="attributes">
            <attribute name="lang">sv</attribute>
        </xpath>
    </template>

    <record model="ir.ui.menu" id="mass_mailing_custom_unsubscribe.mail_unsubscription_menu">
        <field name="name">(Av)anmälningar</field>
    </record>

    <record model="ir.ui.menu" id="mass_mailing_custom_unsubscribe.mail_unsubscription_reason_menu">
        <field name="name">Skäl till avanmälan</field>
    </record>

    <record model="ir.ui.view" id="mail_unsubscription_inherited_tree">
        <field name="name">mail.unsubscription.inherited_remove_unsubscriber_id_tree</field>
        <field name="model">mail.unsubscription</field>
        <field name="inherit_id" ref="mass_mailing_custom_unsubscribe.mail_unsubscription_view_tree"/>
        <field name="arch" type="xml">
            <field name="unsubscriber_id" position="replace">
                <field name="customer_id"/>
            </field>
        </field>
    </record>
    <record model="ir.ui.view" id="mail_unsubscription_inherited_search">
        <field name="name">mail.unsubscription.inherited_remove_unsubscriber_id_search</field>
        <field name="model">mail.unsubscription</field>
        <field name="inherit_id" ref="mass_mailing_custom_unsubscribe.mail_unsubscription_view_search"/>
        <field name="arch" type="xml">
            <field name="unsubscriber_id" position="replace">
                <field name="customer_id"/>
            </field>
        </field>
    </record>
</odoo>
